import{S as h,T as n,E as s}from"./ScrollTrigger.-GiUncv5.js";import{g as d}from"./index.Bc2aDPd5.js";d.registerPlugin(h);class u{timeouts={resizeThrottle:null};hasSiteLoaded=!1;hasWorksReady=!1;introStarted=!1;windowWidth;windowHeight;clientWidth;clientHeight;isScrolling=!1;loaderProgress=0;constructor(){let i="unknown";navigator.userAgent.indexOf("Win")!==-1?i="windows":navigator.userAgent.indexOf("Android")!==-1?i="android":navigator.userAgent.indexOf("Mac")!==-1?i="mac":navigator.userAgent.indexOf("Linux")!==-1&&(i="linux"),document.documentElement.classList.add(`is-${i}`);let e="unknown";navigator.userAgent.indexOf("Firefox")!==-1?e="firefox":navigator.userAgent.indexOf("Chrome")!==-1?e="chrome":navigator.userAgent.indexOf("Safari")!==-1&&(e="safari"),document.documentElement.classList.add(`is-${e}`),this.animateLoader(),this.bindEvents()}init(){n.init(),this.onResize(),document.documentElement.classList.contains("is-works-ready")&&(this.hasWorksReady=!0),this.tryStartIntro()}animateLoader(){const i=document.querySelector(".js-loader-progress");if(!i)return;const e=4e3,t=Date.now(),o=r=>1-Math.pow(1-r,3),a=()=>{const r=Date.now()-t,l=Math.min(r/e,1),c=o(l)*100;i.style.width=`${c}%`,l<1&&requestAnimationFrame(a)};a()}bindEvents(){window.addEventListener("resize",this.resizeThrottle.bind(this)),window.addEventListener("scroll",this.onScroll.bind(this),{passive:!0}),s.on("updateViewport",this.onResize,this,!0),s.on("siteLoaded",this.onSiteLoaded,this,!0),s.on("worksReady",this.onWorksReady,this,!0);const i=new IntersectionObserver(e=>{e.forEach(t=>{t.target.dispatchEvent(new CustomEvent("intersect",{detail:{isIntersecting:t.isIntersecting}})),t.isIntersecting?(t.target.classList.add("is-in-view"),t.target.classList.remove("is-out-of-view","is-out-of-view-top","is-out-of-view-bottom")):(t.target.classList.remove("is-in-view"),t.target.classList.add("is-out-of-view"),t.target.classList.toggle("is-out-of-view-top",t.boundingClientRect.top<0),t.target.classList.toggle("is-out-of-view-bottom",t.boundingClientRect.top>0))})},{threshold:0});document.querySelectorAll("[data-intersect]").forEach(e=>{i.observe(e)}),document.readyState==="complete"?this.siteLoaded():window.addEventListener("load",this.siteLoaded.bind(this),{once:!0}),this.onScroll()}siteLoaded(){setTimeout(()=>{document.documentElement.classList.add("is-loaded"),s.emit("siteLoaded")},150)}onSiteLoaded(){this.hasSiteLoaded=!0,this.tryStartIntro()}onWorksReady(){this.hasWorksReady=!0,this.tryStartIntro()}tryStartIntro(){this.introStarted||!this.hasSiteLoaded||!this.hasWorksReady||(this.introStarted=!0,n.nextTick(this.intro,this))}resizeThrottle(){clearTimeout(this.timeouts.resizeThrottle),this.timeouts.resizeThrottle=setTimeout(()=>{n.nextTick(this.onResize,this)},200)}onResize(){const i=window.innerWidth;let e=!1;this.windowWidth!==i&&(this.windowWidth!==void 0&&(e=!0),this.windowWidth=i,this.clientWidth=document.body.clientWidth);const t=window.innerHeight;let o=!1;this.windowHeight!==t&&(this.windowHeight!==void 0&&(o=!0),this.windowHeight=t,this.clientHeight=document.body.clientHeight),window.safeWidth=i,window.safeHeight=t,window.maxScrollTop=document.body.scrollHeight-window.safeHeight,this.setScrollProgress(),s.emit("resize",e,o)}onScroll(){this.setScrollProgress(),n.nextTick(()=>{s.emit("scroll",window.scrollY)})}setScrollProgress(){window.scrollProgress=window.scrollY/window.maxScrollTop}intro(){const i=document.querySelector(".js-site-wrapper"),e=document.querySelector(".js-site-loader");e&&d.to(e,{opacity:0,duration:.25,onComplete:()=>{e.remove()}}),d.to(i,{opacity:1,duration:.3,onComplete:()=>{document.documentElement.classList.remove("is-scroll-blocked")}})}}const w=new u;w.init();
